@using PetStok.Entities
@using PetStok.Entities.DTOs
@{
    ViewData["Title"] = "Stok Takip";
}

<div class="container-fluid mt-5" id="yukleniyor">
    <div class="row mx-auto">
        <div style="width: 8rem; height: 8rem;" role="status" class="spinner-border col-6 ms-auto">
            <span class="visually-hidden">Yükleniyor...</span>
        </div>
        <div class="col-6 my-auto me-auto">
            <p class="display-3">Veriler Yükleniyor</p>
        </div>
    </div>
</div>
<div class="container-fluid" id="content-div" style="position: relative;overflow: hidden;">
    <div style="position: absolute;top: 5000px;" id="style-div">
        <div class="row">
            <p class="col-12 display-5">Stok Takip</p>
        </div>
        @*Filtreleme Şeyleri*@
        <div class="row">
            <div class="form-floating col-3 my-auto py-auto">
                @*Barkod girişi*@
                <input class="form-control form-control-dark" type="text" for="Barkod" placeholder="Barkod Ara" id="barkodArama" onkeyup="barkodAra()">
            </div>
            @*Site Seçme*@
            <div class="col-3 form-floating my-auto py-auto">
                <select class="form-select" id="adSelect" for="SiteAdi" onchange="adSec()">
                    <option value="">Hepsini göster</option>
                    @{
                        foreach (var ad in ViewBag.adlar)
                        {
                            <option value=@ad>@ad</option>
                        }
                    }
                </select>
            </div>
            @*Tarih Seçme*@
            <div class="form-floating col-3 my-auto py-auto">
                <input class="h-75 form-control" type="date" for="date" onchange="tarihSec()" id="tarihSelector" name="date" value=@ViewBag.Date.ToString("yyyy-MM-dd")>
            </div><div class="col-3">
                <form asp-for="Home" asp-action="Guncelle" method="post">
                    <button type="button" class="btn btn-primary" onclick="this.form.submit()">Verileri İndir ve Güncelle</button>
                </form>
            </div>
        </div>
        <div class="row table-responsive text-start">
            <table class="table table-striped table-sm" id="productTable">
                @*tablo başlığı*@
                <thead>
                    <tr>
                        <th scope="col">Barkod</th>
                        <th scope="col">Ürün Adı</th>
                        <th scope="col">Marka</th>
                        <th scope="col">Önceki Stok</th>
                        <th scope="col">Sonraki Stok</th>
                        <th scope="col">Şuanki Stok</th>
                        <th scope="col">Stok Farkı</th>
                        <th scope="col">Stok Tarihi</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (ProductDTO product in ViewBag.productDTOs)
                    {
                        <tr class="product">
                            <td class="barkod">@product.barkod</td>
                            <td class="urunAd">@product.urunAd</td>
                            <td class="ad">@product.ad</td>
                            <td class="oncekiStok">@product.oncekiStok.stok</td>
                            <td class="sonrakiStok">@product.sonrakiStok.stok</td>
                            <td class="guncelStok">@product.stok</td>
                            <td class="stokFarki">@(product.oncekiStok.stok-product.sonrakiStok.stok)</td>
                            <td class="stokTarihi">@product.sonrakiStok.tarih.ToString("yyyy-MM-dd HH:mm") </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>
@*Toast bildirimi*@
<div class="position-fixed top-0 end-0 p-3 mt-5" style="z-index: 11">
    <div id="liveToast" class="toast bg-danger text-white hide" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <strong class="me-auto text-black">Geçersiz Tarih!</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            Seçtiğiniz tarihte veri bulunmamaktadır. Diğer arama kriterlerine uyan tüm sonuçlar gösteriliyor.
        </div>
    </div>
</div>
@*2 tikli şey
    <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox1" value="option1">
            <label class="form-check-label" for="inlineCheckbox1">Popüler Ürünler</label>
            </div>
            <div class="form-check form-check-inline">
            <input class="form-check-input" type="checkbox" id="inlineCheckbox2" value="option2">
            <label class="form-check-label" for="inlineCheckbox2">Json Link Ürünler</label>
            </div>*@